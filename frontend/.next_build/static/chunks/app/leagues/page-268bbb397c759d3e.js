(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73],{9236:(e,t,n)=>{Promise.resolve().then(n.bind(n,7961))},6463:(e,t,n)=>{"use strict";var a=n(1169);n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}})},7961:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var a=n(7437),s=n(2265),r=n(6463),c=n(2800),i=n(3508);function o(){let[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(!0),[l,u]=(0,s.useState)(""),[d,h]=(0,s.useState)(!0),[g,m]=(0,s.useState)(null);(0,s.useEffect)(()=>{(0,c.getLeagues)().then(e=>t(e)).catch(e=>m(String(e))).finally(()=>o(!1))},[]);let f=async e=>{e.preventDefault(),m(null);try{let e=await (0,c.createLeague)({name:l,is_public:d});t(t=>[e,...t]),u("")}catch(e){m((null==e?void 0:e.message)||"Failed to create")}},y=(0,r.useRouter)(),x=async e=>{try{let t=await (0,c.joinLeague)(e);t&&t.created,y.push("/my-team")}catch(e){alert("Failed to join: "+String(e))}};return(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Leagues"}),(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"font-semibold",children:"Create League"}),(0,a.jsx)(i.Z,{children:(0,a.jsxs)("form",{onSubmit:f,className:"mt-3 space-y-3",children:[g&&(0,a.jsx)("div",{className:"text-red-600",children:g}),(0,a.jsx)("input",{value:l,onChange:e=>u(e.target.value),placeholder:"League name",className:"w-full border rounded px-3 py-2"}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:d,onChange:e=>h(e.target.checked)})," Public"]}),(0,a.jsx)("button",{className:"bg-slate-800 text-white px-4 py-2 rounded",children:"Create"})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"font-semibold",children:"Available Leagues"}),n&&(0,a.jsx)("p",{className:"mt-2",children:"Loading..."}),!n&&(0,a.jsx)("ul",{className:"mt-3 space-y-2",children:e.map(e=>(0,a.jsxs)("li",{className:"border rounded p-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-slate-500",children:["Owner: ",e.owner]})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{onClick:()=>x(e.id),className:"px-3 py-1 border rounded",children:"Join"})})]},e.id))})]})]})]})}},3508:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(7437),s=n(2265),r=n(6463),c=n(2800);function i(e){let{children:t}=e,[n,i]=(0,s.useState)(!0),o=(0,r.useRouter)();return((0,s.useEffect)(()=>{let e=!0;return(0,c.me)().then(()=>{e&&i(!1)}).catch(()=>{e&&o.push("/login")}),()=>{e=!1}},[o]),n)?(0,a.jsx)("div",{className:"p-8",children:"Checking authentication..."}):(0,a.jsx)(a.Fragment,{children:t})}},2800:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createLeague:()=>x,createTeam:()=>j,getEvents:()=>h,getFighter:()=>o,getFighters:()=>i,getLeagues:()=>y,getStandings:()=>f,getTeam:()=>g,joinLeague:()=>p,login:()=>l,logout:()=>c,me:()=>d,register:()=>u,setTokens:()=>r,updateTeam:()=>m});let a=n(357).env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={"Content-Type":"application/json"},s=localStorage.getItem("accessToken");s&&(n.Authorization="Bearer ".concat(s));let r=await fetch("".concat(a).concat(e),{credentials:"include",headers:n,...t});if(401===r.status)throw localStorage.removeItem("accessToken"),Error("Unauthorized");if(!r.ok)throw Error(await r.text()||r.statusText);return 204===r.status?null:r.json()}function r(e,t){localStorage.setItem("accessToken",e),t&&localStorage.setItem("refreshToken",t)}function c(){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}async function i(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",String(e.page)),(null==e?void 0:e.search)&&t.set("search",e.search);let n=t.toString()?"?".concat(t.toString()):"";return s("/fighters/".concat(n))}async function o(e){return s("/fighters/".concat(e,"/"))}async function l(e,t){let n=await s("/auth/login",{method:"POST",body:JSON.stringify({username:e,password:t})});return n&&n.access&&r(n.access,n.refresh),n}async function u(e,t,n){return s("/auth/register",{method:"POST",body:JSON.stringify({username:e,password:t,email:n})})}async function d(){return s("/auth/me")}async function h(){return s("/events/")}async function g(){return s("/teams/my/")}async function m(e){return s("/teams/update/",{method:"POST",body:JSON.stringify(e)})}async function f(e){return s("/scoring/league/".concat(e,"/"))}async function y(){return s("/leagues/")}async function x(e){return s("/leagues/",{method:"POST",body:JSON.stringify(e)})}async function p(e){return s("/leagues/".concat(e,"/join/"),{method:"POST"})}async function j(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return s("/teams/create/",{method:"POST",body:JSON.stringify({league_id:e,fighter_ids:t})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[130,215,744],()=>t(9236)),_N_E=e.O()}]);